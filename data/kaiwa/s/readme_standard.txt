
-------------------------------------------------------------
  東方模倣風  〜 Toho Imitation Style.
  プロジェクトページ http://code.google.com/p/kene-touhou-mohofu/
-------------------------------------------------------------

; ステージデーターです。
; STAGE1.TXT    1面のステージデーター(魔法の森)
; STAGE2.TXT    2面のステージデーター(迷いの竹林)
; STAGE3.TXT    3面のステージデーター(永遠亭)
; STAGE4.TXT    4面のステージデーター(妖怪の山)
; STAGE5.TXT    5面のステージデーター(図書館)
; STAGE6.TXT    6面のステージデーター(大廊下)
; STAGE7.TXT    エンディング用スタッフロール
; STAGE8.TXT    extra用
; STAGE9.TXT    phantazm用
; STAGE0.TXT    phantazm用スタッフロール
;
;---------------------------
; ※ この文書は開発中の為、校閲が出来ていません。(r39時点で一通り見ましたが、どうせすぐこの文書は古くなります)
;    計画中の仕様や廃止した仕様が混ざっていて地味に間違っているかもしれないので、
;    不明な点はソースリスト(src/game_core/load_stage.c)(src/game_core/douchu/以下)を確認してください。
;
; ※ データー書式は開発中(規格策定中)であり、release が変わると大抵変わります。
; ※ 書式が同じでも、release が変わると実装されていない動作が実装されていたり、廃止されていたりします。
; ※ 廃止するのは、他の書式で同じ事が書けるようになった為、重複するので要らないからです。
;
;---------------------------
; データーの形式単位用語の説明(r39時点):
; [pixel]:
;   pspの画面上の1ドットの点を基準とした単位。1[pixel]は、1ドット。
; [t256]:
;   1.00==256[t256]形式を基準とした単位。256[t256]形式は、1[ドット/フレーム]==60[pixel/秒]。
;   つまり最小単位 (1.0/256.0)==0.00390625==約0.004==1[t256]形式を設定すると約4秒で1[pixel]動く。
; [0.25hp]:
;   1/4単位で設定する。 030 なら 120[hp]
; [score]:
;   1/10単位で設定する。 030 なら 300[pts]
; [deg1024]:
;   1周を1024分割した単位で設定する。256 なら 角度が 90[度]
;   つまり最小単位 (360.0/1024.0)==0.3515625==約0.3[度]
;   360x3==1080 =:= 1024 なので、概算では3をかける。
;   ( (360 x 3) - (360/6) + (360/90) == 1024 )
; 模倣風では[下CCW]という単位系を使用しています。これは数学の[右CW]のx軸とy軸を単純に入れ替えたものです。
; どうしてそんな変な単位系を採用しているのか？というと、
; 上か下が0度の単位系にすると、左右対称な弾幕を作成するのに最も効率が良いという理由が一つ。
; もう一つは、(x軸とy軸を入れ替えただけなので)既存の数学関数式が簡単に利用できる
; (新しい理論を考えなくても既存の物で面白そうな考えがあればそのまま流用できる)という理由が一つ。
; 以上２つの理由です。
; 左右対称な弾幕の場合は、角度の変換(左右入れ替え)が簡単です。
;   0:   0度。下向き。
; 256:  90度。右向き。
; 512: 180度。上向き。
; 768: 270度。左向き。
;1023: だいたい下向き。最大値。
;1024: 使用できないが、無理に使用すると 0度 と同じに扱われる。(つまり使用できるが非推奨)
;内部では0-65535[deg65536]で使用しているので、0-1023は読みこみ後に内部値の0-65535へ変換されます。
;datだと読みにくいと思い、程々の精度の[deg1024]にしてあります。[deg256]じゃ5分割とか7分割とかすると誤差が大きすぎて荒すぎますし。
;[deg1024]でも紅魔郷の13分割程度なら結構綺麗に出ます。本家では108分割(人間の煩悩の数から?)の弾幕があるので[deg1024]では精度が足りません。
;(測定したら107分割より細かく、109分割より荒かったので108分割と断定したが、もっと精度良く調べれば違う可能性もある。)
;108分割を綺麗に出す為に内部精度は[deg65536]にしてあります。
;内部では描画のみ0-1023を使用しています。
;(描画の場合0-65535より0-1023の方がvfpuに1命令で変換できて効率が良いので、0-65535から0-1023へ変換して使用しています)
;---------------------------
;
; データーの書式説明(r39時点):
;
; ','で区切る。基本書式はcsv(カンマ区切り)。しかしながら' 'が使えないバグがある。
; 上位桁を揃えたい場合、現在' 'が使えないバグがあるので上位桁は'0'で埋める。
;
; 行頭が';'で始まる行はコメント行なので、無視される。
;
; 現状ボスを倒すと次の面が始まる。
;
; ※ (r39)内部名称は、プログラム内部で区別している名称(src/game_core/load_stage.c)。
;
; ※ 必ず敵は 1行==1敵。
; ※ 変換中なので、(r39)現在ザコによって仕様がバラバラな部分がある。
;
;  n番目:(r39)内部名称:         説明(意味)
;  1番目:time60:                1/60 秒単位の出現時間。
;  2番目:int_user_i_code:       種類コマンド (0-7までの数字) (0: 雑魚, 1: スペカ雑魚, 2:会話, 3:スクロール速度, 4:ゲーム終了。 )。   //旧仕様メモ (0-255までの数字) (0,8,16,24: 雑魚, 1,9,17,25: スペカ雑魚, 2:会話, 3:スクロール速度, 4:ゲーム終了。 )。
;  3番目:user_255_code:         (r39現在)ザコ敵の場合、user_255_codeは、動き種類(0-19までの数字)
;  4番目:select_gazou:          敵の画像を決める。 アニメーション選択(回転、パターン) 
;  5番目:kougeki_type:          敵が攻撃する場合のスペカの種類。(r35現在仕様がバラバラ)
;  6番目:locate_x:              位置 x座標[pixel]形式。 ( x座標 )[(r34)中ボスの場合、登場予定座標]。;   (r39現在仕様がバラバラ。統一作業中)[pixel]形式
;  7番目:locate_y:              位置 y座標[pixel]形式。 ( y座標, 敵: 難易度)。;   (r39現在仕様がバラバラ。統一作業中)[pixel]形式
;
;  8番目:user_angle1024:        (r39追加)角度[deg1024]形式。
;  9番目:user_speed256:         (r39追加)速度[t256]形式。
;
; 10番目:user_hp:               体力。体力(ザコ/中ボスのみ設定可能。ボスは無理。)
; 11番目:user_item8:            倒した場合に出現するアイテム種類。 アイテム種類。
; 12番目:user_score:            倒した場合に獲得できるスコア。スコア(1/10単位、 030 なら 300[pts])
;---------------------------
; 以下、各コマンドについて、もうちょっと詳しく説明。
;---------------------------
; ■ [2番目:int_user_i_code]: (0-7までの数字)。 (src/game_core/game_core.c)参照。
; 0: =="妖怪" user_255_code の番号の「その他の妖怪(つまり雑魚)」を追加する。(妖怪退治ですし)
; 1: =="魔法" user_255_code の番号の背後に魔方陣があり、スペルを撃つ事が出来る妖怪(つまり中ボス)を追加する。
; 2: =="会話"に関しては、キャラクタを追加するのではなくて、会話シナリオを呼ぶコマンド。
; DAT からシナリオを呼ぶ場合に、選択プレイヤーによって読むシナリオファイル名が変わるコマンドを追加するかもしれない。
;  中-ボスに関しては未定。 
; 3: =="BG" 背景の制御コマンド(3)。背景のスクロール速度を設定する。(他の機能はr39現在無い)
; 4: =="QUIT" ゲーム終了コマンド。 全ステージ クリアーを指示。このコマンド(4)は全ステージクリアしてエンディングスタッフロールも見たと言う意味。
; その場合、ゲームを終了してリザルト("あなたの腕前")を出す。
; 5: =="QUIT" (r39現在)未使用。未使用なのでゲーム終了コマンドと同じに割り当ててある。
; 6: =="QUIT" (r39現在)未使用。未使用なのでゲーム終了コマンドと同じに割り当ててある。
; 7: =="QUIT" (r39現在)未使用。未使用なのでゲーム終了コマンドと同じに割り当ててある。
;---------------------------
; ■ [3番目:user_255_code]: (r39現在)敵_動き種類(0-19までの数字)。 (src/douchu/teki.c::game_command_00_regist_zako)参照。
;---------------------------
;000        "魔方陣1",  /* "GROUNDER" */       (r33)特殊機能:[攻撃タイプ==スペカ0...7]
;001        "魔方陣2",  /* "MAGICF" */         (r33)特殊機能:[攻撃タイプ==スペカ0...7]
;   /* 竜巻 陰陽玉 */
;002        "陰陽玉1",  /* "PLASMABALL" */     (r33)特殊機能:[攻撃タイプ==y閾値0...15]
;003        "竜巻1",    /* "PROBALL" */
;   /* 妖怪 */
;004        "囲妖怪1",  /* "CUBE" */
;005        "赤毛玉1",  /* "MINE" */       /* 橙 */
;   /* 毛玉 */
;006        "隕石1",    /* "MING" */       /* その他ザコ */ (画像？？？)
;007        "紫編隊2",  /* "GREETER" */    /* その他ザコ */
;008        "緑毛玉1",  /* "XEV" */
;009        "緑毛玉2",  /* "CRUSHER" */
;010        "毛玉1",    /* "BADGUY" */
;011        "毛玉2",    /* "BADGUY" */     (r33)特殊機能:[攻撃タイプ==0紅,1妖]
;   /* [C妖精]その他ザコ */
;012        "青妖精2",  /* [共通化] "SPLASH" "おばけ1" "DRAGER" */     // [***090124       追加
;013        "おばけ2",  /* "EYEFO" */
;014        "烏1",      /* [共通化] "SPLASH" "青妖精3"  */
;   /* [B妖精]中妖精 */
;015        "メイド1",  /* "RWINGX" */
;016        "メイド2",  /* "ZATAK" */
;017        "メイド3",  /* "CURVER" */
;018        "メイド4",  /* "CIR" */
;   /* [A妖精]小妖精 */
;019        "青妖精1",  /* "FAIRY" */      // [***090207       追加
;---------------------------
; ■ 策定中仕様。
;(r39)本来 user_255_code にHV反転を入れたいが、10進数だとDATが解かりにくい。(16進数なら解かりやすい)
(元々想定していた雑魚number[0-127]と言う仕様は[0-31] x 2 x 2 でHV反転を含んだもの。)
そこでとりあえず。int_user_i_code にHV反転を入れておく。
;---------------------------
;(r39)[種類コマンド]一覧    (r38)[種類コマンド]一覧
;   4   12  20  28          QUIT        // ゲーム 全ステージ クリアー 指示。
;   3   11  19  27          BG          //  "BG_CONTROL"    背景制御用コマンド(現時点ではスクロール速度を指定する)
;   2   10  18  26          会話        /* (ボス)用 会話シナリオ起動 */
;   1   9   17  25          魔法        /* ザコ/中ボス(会話シナリオ起動しない) */
;   0   8   16  24          妖怪        /* ザコ */
;   正  横  縦  逆
;---------------------------
;(r39)雑魚、移動方法。
;   正                      基準となる通常移動。
;   横                      横移動が逆になる。
;   縦                      縦移動が逆になる。
;   逆                      横移動、縦移動共に逆になる。
;---------------------------
; ■ [8番目:user_angle1024]: 
;(r39)user_angle1024。
;   角度は[0...1023]まで。
;   (下が0度、反時計回りで。右=256、上=512、左=768)。
;   角度=1024で自機狙い角を生成(r39暫定仕様)。
;---------------------------
; ■ [11番目:user_item8]: 
(r34)仮仕様 アイテム 番号(0-15)
 0 [p]   (アイテム0) 小P +1power.
 1 [P]   (アイテム1) 中P +8power.
 2 [F]   (アイテム2) 大P power MAX.
 3 [1up] (アイテム3) player extend.
 4 [B]   (アイテム4) Bomber.
 5 [点]  (アイテム5) score.
 6 [☆]  (アイテム6) 星点(datでは使わない事を推奨)
 7 未定  (アイテム7) (仮、ランダム)
 8 ランダムテーブルを使う。
 9 攻撃魔方陣用。 ( 30%[P] + 30%[P] + 30%[Ten] ) 最小[0] 最大[3]
10 陰陽ザコ002用。   ( 12.5%[自機狙い] | 43.75%[p] | 43.75%[P] ) 最小[1] 最大[1]
11 未定  (仮、ランダム)
12 未定  (仮、ランダム)
13 未定  (仮、ランダム)
14 (旧中ボス)
15 (旧ルーミア)
;---------------------------
; ■ スクロール速度。
;   BG命令の user_y パラメーターを使用して、スクロール速度を設定する。
;   スクロール速度とは、1フレームあたりスクロール値が幾つ増えるかの設定。
;   例えば設定が 0128 (==t256(0.5))なら pspは1秒間約60フレームなので、
;   1秒間でスクロール値が 30 増える。(と言う基準速度でスクロールする)
;   ステージ開始時のスクロール速度、初期値は    0128 ==t256(0.5) ==1フレームあたりスクロール値が0.5増える設定
;---------------------------
; ★ BGスクロール速度変換メモ
;(-r33)0200,BG,01,,,,,,,0
;(r34-)0200,BG,,,,,0025,,,0
;   (rずっと前)     (-r33形式)          (r34-形式)  ; 値の意味(1フレームあたりの増加スクロール値)   ;
;   1文字コマンド   user_255_code???    user_y      ; 模倣風                ; 参考値 KETM version 0.9
;   0               00                  0000        ; t256(0.0)             ; t256(0.5) (KETMで使用)   [初期値]
;   1               01                  0025        ; t256(0.1)             ; t256(0.1) (KETMで未使用)
;   2               02                  0051        ; t256(0.2)             ; t256(0.2) (KETMで未使用)
;   3               03                  0076        ; t256(0.3)             ; t256(0.3) (KETMで未使用)
;   4               04                  0102        ; t256(0.4)             ; t256(0.4) (KETMで未使用)
;   5               05                  0128        ; t256(0.5) [初期値]    ; t256(0.5) (KETMで使用)
;   6               06                  0153        ; t256(0.6)             ; t256(0.6) (KETMで使用)
;   7               07                  0179        ; t256(0.7)             ; t256(0.7) (KETMで使用)
;   8               08                  0204        ; t256(0.8)             ; t256(0.8) (KETMで使用)
;   9               09                  0230        ; t256(0.9)             ; t256(0.9) (KETMで使用)
;   J               10                  0256        ; t256(1.0)             ; t256(0.5) (KETMで未使用)
;   K               11                  0384        ; t256(1.5)             ; t256(0.5) (KETMで未使用)
;   L               12                  0512        ; t256(2.0)             ; t256(0.5) (KETMで未使用)
;   M               13                  0640        ; t256(2.5)             ; t256(0.5) (KETMで未使用)
;   N               14                  0768        ; t256(3.0)             ; t256(0.5) (KETMで未使用)
;   O               15                  1024        ; t256(4.0)             ; t256(0.5) (KETMで未使用)
; ※参考値 KETM version 0.9(で設定した場合の動作値。但しKETMの場合、60[flame]でなくて20[flame]ぐらいなので３倍ぐらいスクロール速度が遅い)
;
;  
255: ) // (r34)一時廃止, 128: ファイル名('0'で始まる名前は特殊機能)
;---------------------------
; ■ 出現位置についてのメモ: 
; (-r34)ゲーム画面幅 352[pixel] == 480(psp幅)-128(パネル幅)
; (-r34)11 == 352/32, つまり 32[pixel]間隔で出現する場合、11分割出来るので, 11通り(0 〜 10)の位置がある。
; (r35-)ゲーム画面幅 320[pixel] == 480(psp幅)-128(右パネル幅)-32(左パネル幅)
; (r35-)10 == 320/32, つまり 32[pixel]間隔で出現する場合、10分割出来るので, 10通り(0 〜 9)の位置がある。
;   0   1   2   3   4   5   6   7   8   9  10 [11]  (x位置chars)出現基準 X 座標 (32[pixel]ずつ加算するとして)
; 000 032 064 096 128 160 192 224 256 288 320 [352] (x位置[pixel]) [-r31] objの左上隅が基準
; 016 048 080 112 144 176 208 240 272 304 336 [368] (x位置[pixel]) [r32-] objの中心が基準(仮に32x32objとして16[pixel]ずらす) 
; 048 080 112 144 176 208 240 272 304 336[368][400] (x位置[pixel]) [r35-] objの中心が基準(仮に32x32objとして48[pixel]ずらす)
; [-r31] objの左上隅が基準だった。
; [r32-] objの中心が基準に変更した。仮に32x32objとした場合は、半分の16[pixel]ずらす必要がある。
; [r35-] objの中心が基準なのは変わらないが、左端に32[pixel]の[左サイドパネル]が出来たので、その分(32+16==48[pixel])ずらす必要がある。

; [r32-] メモ：X座標 [左88]  [中心176] [右264] [最大352]
; [r32-] メモ：Y座標 [上32]  [中心 64] [下 96] [最大128]
; [r32-] メモ：414 == 320*[1.29 game aspect rate]
; [r35-] メモ：376 == 320*[1.17 game aspect rate]

; [r32-]  1.29411764705882352941176470588235 == [1.29 game aspect rate] == (480[psp横] - 128[右サイドパネル]) / 272[psp縦]
; [r32-]  414.117647058823529411764705882353

; [r35-]  1.17647058823529411764705882352941 == [1.17 game aspect rate] == (480[psp横] - 128[右サイドパネル] - 32[左サイドパネル]) / 272[psp縦]
; [r35-]  376.47058823529411764705882352928

;---------------------------
(r34の場合)
3890,中ボス,1,020,8,286,050,1856,14,3000
;  3番目:user_255_code:     1==背景魔方陣の色
;  4番目:select_gazou:      020==中ボス画像
;  5番目:kougeki_type:      8:紅1面ボス ルーミア 夜符「ナイトバード」にちょっとだけ似た弾幕(予定)
;  6番目:user_x:            x座標 
;  7番目:user_y:            y座標 (登場予定 y 座標)
;  8番目:user_hp:           体力
;  9番目:user_item8:        アイテム種類
; 10番目:user_score:        スコア(1/10単位、 030 なら 300[pts])
;---------------------------
;---------------------------
(r35の場合)
5300,ボス,1,,,192,-100,,,100000

;  6番目:user_x:            x座標 
;  7番目:user_y:            y座標 (登場予定 y 座標)
(r35時点で)体力はまだ反映されない。
; 10番目:user_score:        スコア(1/10単位、 030 なら 300[pts])

;192 == 32 + ((480-128-32)/2) == サイドパネル左 + ((psp画面幅-サイドパネル右-サイドパネル左)/2) == ボスを画面中心に登場させる場合
;---------------------------
; ■ 旧仕様メモ。
; 浮遊物設定
;0060,bg/cloud10.png,0,0,,1,127,030,8,10
;0060,bg/cloud10.png,0,0,,1,127,030,8,10
;0060,bg/cloud10.png,0,0,,1,127,030,8,10
;0060,bg/cloud10.png,0,0,,1,127,030,8,10
;0060,bg/cloud10.png,0,0,,1,127,030,8,10
;0060,bg/cloud11.png,0,0,,1,255,030,8,10
;0060,bg/cloud11.png,0,0,,1,255,030,8,10
;0060,bg/cloud12.png,0,0,,1,383,030,8,10

; 浮遊物設定
;0060,bg/cloud20.png,0,0,,1,127,030,8,60
;0060,bg/cloud20.png,0,0,,1,127,030,8,60
;0060,bg/cloud20.png,0,0,,1,127,030,8,60
;0060,bg/cloud20.png,0,0,,1,127,030,8,60
;0060,bg/cloud20.png,0,0,,1,127,030,8,60
;0060,bg/cloud21.png,0,0,,1,255,030,8,60
;0060,bg/cloud21.png,0,0,,1,255,030,8,60
;0060,bg/cloud22.png,0,0,,1,383,030,8,60


;6060,bg/アリス用スペル.jpg,128,,,,,,,0
;6060,bg/射命丸戦背景.jpg,128,,,,,,,0
;6060,bg/アリス用スペル.jpg,128,,,,,,,0
